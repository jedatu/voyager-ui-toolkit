var vs;!function(t){var n;!function(t){"use strict";var n=function(){function t(t){t.debugEnabled(!0)}return t.$inject=["$logProvider"],t}();t.Config=n}(n=t.tools||(t.tools={}))}(vs||(vs={}));var vs;!function(t){var n;!function(t){"use strict";var n=function(){function t(t){t.debug("runBlock end")}return t.$inject=["$log"],t}();t.RunBlock=n}(n=t.tools||(t.tools={}))}(vs||(vs={}));var vs;!function(t){var n;!function(t){"use strict";angular.module("vs.tools",[]).config(t.Config).run(t.RunBlock).constant("config",config)}(n=t.tools||(t.tools={}))}(vs||(vs={}));var vs;!function(t){var n;!function(t){var n;!function(t){"use strict";angular.module("vs.tools.displayConfig",[])}(n=t.displayConfig||(t.displayConfig={}))}(n=t.tools||(t.tools={}))}(vs||(vs={})),angular.module("vs.tools.displayConfig").factory("displayConfigResource",["$http",function(t){"use strict";function n(){var t=a+"list";return t+="?rand="+Math.random()}function o(t){var n=a+t;return n+="?rand="+Math.random()}function r(){return t.get(n()).then(function(t){return t},function(t){return console.log(t),t})}function e(n){return t.get(o(n)).then(function(t){return t},function(t){return console.log(t),t})}function s(n){return t["delete"](o(n)).then(function(t){return t},function(t){return console.log(t),t})}function i(n){return t.post(a,n).then(function(t){return t},function(t){return console.log(t),t})}var a=config.root+"api/rest/display/config/";return{getDisplayConfigs:function(){return r()},getDisplayConfig:function(t){return e(t)},deleteDisplayConfig:function(t){return s(t)},saveDisplayConfig:function(t){return i(t)}}}]);var vs;!function(t){var n;!function(t){var n;!function(t){"use strict";angular.module("vs.tools.filters",[]).filter("replaceString",function(){return function(t,n,o){return t.replace(n,o)}})}(n=t.filters||(t.filters={}))}(n=t.tools||(t.tools={}))}(vs||(vs={}));var vs;!function(t){var n;!function(t){var n;!function(t){var n=function(){function t(t,n){this.config=t,this.$http=n}return t.isString=function(t){return"string"==typeof t||t instanceof String},t.getInstance=function(n,o){return new t(n,o)},t.prototype.toMap=function(t,n){var o={};return n.forEach(function(n){o[n[t]]=n}),o},t.prototype.toStringMap=function(t){var n={};return t.forEach(function(t){n[t]=t}),n},t.prototype.pluck=function(t,n,o){var r=[];return t.forEach(function(t){o&&o(t)?r.push(t[n]):angular.isUndefined(o)&&r.push(t[n])}),r},t.prototype.postForm=function(t,n){var o=this.config.root+t;return this.$http({method:"POST",url:o,data:n,withCredentials:!0,headers:{"Content-Type":"application/x-www-form-urlencoded"}})},t.prototype.parseQueryString=function(t){var n,o=t.slice(1).split("&"),r={};return o.forEach(function(t){n=t.split("="),r[n[0]]=decodeURIComponent(n[1]||"")}),JSON.parse(JSON.stringify(r))},t.prototype.postJson=function(t,n,o){return this.$http({method:"POST",url:config.root+"api/rest/"+n+"/"+o+".json",data:t,headers:{"Content-Type":"application/json"}})},t}();t.Sugar=n}(n=t.util||(t.util={}))}(n=t.tools||(t.tools={}))}(vs||(vs={}));var vs;!function(t){var n;!function(t){var n;!function(t){"use strict";var n=function(){function t(t){var n=this;this.sugar=t,this.fetch=function(o){var r=o||"name,category,docs,disp_en";return t.postForm("solr/fields/select",n.getFieldsParams(r)).then(function(t){return t.data.response.docs})},this.fetchHydrationStats=function(o){return n.fetch().then(function(r){var e=t.pluck(r,"name",function(t){return 0!==t.name.indexOf("_")&&t.docs>0});return t.postForm("solr/v0/select?"+o,n.getStatsParams(e)).then(function(t){var o=t.data.facet_counts.facet_fields,e=t.data.response.numFound;return n.applyHydration(o,r,e),r})})}}return t.$inject=["sugar"],t.prototype.getFieldsParams=function(t){return"q=*:*&fl="+t+"&rows=10000&sort=name%20asc&wt=json"},t.prototype.getStatsParams=function(t){return"facet=true&facet.limit=10000&facet.mincount=100&rows=0&wt=json&facet.field="+t.join("&facet.field=")},t.prototype.applyHydration=function(t,n,o){for(var r,e,s=0;s<n.length;s++)r=t[n[s].name],r&&r.length>0&&(n[s].id=n[s].name,e=this.getCount(r),n[s].hydration=e/o*100);return s},t.prototype.getCount=function(t){for(var n=0,o=1;o<t.length;o+=2)n+=t[o];return n},t.refName="fieldsResource",t}();t.FieldsResource=n}(n=t.fields||(t.fields={}))}(n=t.tools||(t.tools={}))}(vs||(vs={}));var vs;!function(t){var n;!function(t){var n;!function(t){"use strict";angular.module("vs.tools.fields",["vs.tools.util"]).service(t.FieldsResource.refName,t.FieldsResource)}(n=t.fields||(t.fields={}))}(n=t.tools||(t.tools={}))}(vs||(vs={}));var vs;!function(t){var n;!function(t){var n;!function(t){"use strict";angular.module("vs.tools.savedSearch",["vs.tools.util"])}(n=t.savedSearch||(t.savedSearch={}))}(n=t.tools||(t.tools={}))}(vs||(vs={})),angular.module("vs.tools.savedSearch").factory("savedSearchResource",["$http","sugar",function(t,n){"use strict";function o(t){return n.postJson(t,"display","ssearch")}function r(t){var n=150,o=config.root+"solr/ssearch/select?";return o+="rows="+n+"&rand="+Math.random(),o+="&fl=id,title,description,owner,path,share,query,config,order,saved,private,view,_version_,config_title:[configTitle],param*,labels",o+="&wt=json&json.wrf=JSON_CALLBACK",angular.isDefined(t)&&(o+="&fq=id:"+t),o}function e(n){return t.jsonp(r(n)).then(function(t){return t.data.response.docs},function(t){return console.log(t),t})}return{getSavedSearches:function(){return e()},fetch:function(t){return e(t).then(function(t){return t[0]})},saveSearch:function(t,n){return o(t)},deleteSearch:function(n){return t["delete"](config.root+"api/rest/display/ssearch/"+n).then(function(){})},order:function(t,n,o){var r="";null!==n&&(r+="before="+n),""!==r&&(r+="&"),null!==o&&(r+="after="+o)},fetchLabels:function(){var n=config.root+"solr/ssearch/select?rows=0&facet=true&facet.field=labels&wt=json&r="+(new Date).getTime();return t.get(n).then(function(t){return t.data.facet_counts.facet_fields.labels},function(){return[]})}}}]);var vs;!function(t){var n;!function(t){var n;!function(t){"use strict";angular.module("vs.tools.util",[]).factory("sugar",["config","$http",function(n,o){return t.Sugar.getInstance(n,o)}])}(n=t.util||(t.util={}))}(n=t.tools||(t.tools={}))}(vs||(vs={}));var vs;!function(t){var n;!function(t){var n;!function(t){var n=function(){function t(t,n,o){this.config=t,this.$http=n,this.$q=o,this.fields=null}return t.$inject=["config","$http","$q"],t.prototype.load=function(){var t=this,n=this.config.root+"api/rest/i18n/fields/standard.json";return this.fields?this.$q.when():this.$http.get(n).then(function(n){return t.fields=n.data,n.data})},t.prototype.translateField=function(t){var n=this.fields.FIELD[t];return angular.isDefined(n)?n:this.classify(t)},t.prototype.classify=function(t){return t=t.replace(/_/g," "),t.replace(/\w\S*/g,function(t){return t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()})},t}();t.Translator=n}(n=t.translate||(t.translate={}))}(n=t.tools||(t.tools={}))}(vs||(vs={}));var vs;!function(t){var n;!function(t){var n;!function(t){"use strict";angular.module("vs.tools.translate",[]).factory("translator",["config","$http","$q",function(n,o,r){return new t.Translator(n,o,r)}]).constant("config",config)}(n=t.translate||(t.translate={}))}(n=t.tools||(t.tools={}))}(vs||(vs={}));
//# sourceMappingURL=maps/vs.toolkit.min.js.map
